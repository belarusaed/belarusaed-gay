---
title: 'Беларуская агучка STYTJ02YM'
description: 'Інструкцыя па ўсталёўцы агучкі на Xiaomi Mi Robot Vacuum-Mop P (STYTJ02YM)'
date: '2021-08-02'
heroImage: '/blog/stytj02ym-voicepack-install-legacy/hero.jpg'
---

### Увага! За ўсе дзеянні несяце адказнасць вы і толькі вы. Ні аўтар інструкцыі, ні той, хто агучваў, ні хто заўгодна яшчэ не бярэ на сябе адказнасць за магчымыя праблемы. Дзеянні, апісаныя ніжэй, таксама могуць пазбавіць вас гарантыі на ваш пыласос, улічвайце гэта.

**Увага! Перад тым, як спрабаваць скарыстацца гэтым спосабам, паспрабуйце спачатку ўсталяваць агучку
праз [vacuum.mindsolo.net](https://vacuum.mindsolo.net). Звярніцеся да гэтай інструкцыі, калі ў вас не атрымалася
ўсталяваць
праз сайт (на сайце бываюць тэхнічныя работы, з-за якіх усталёўка агучак можа быць недаступнай для пэўных мадэлей). Калі
вы ўжо карысталіся гэтай інструкцыяй, усталёўка агучкі праз дадзены сайт недаступная.**

**Увага! Інструкцыя правераная толькі на кітайскай версіі пыласоса. Усе папраўкі на еўрапейскую версію — толькі здагадкі
аўтара. Калі вы спрабуеце скарыстацца інструкцыяй для еўрапейскага пыласоса — магчыма спатрэбіцца ўнікнуць крыху больш і
паэксперыментаваць. Калі вы жывяце ў Менску, маеце еўрапейскую версію пыласоса і гатовыя даручыць камусьці ўсталёўку
агучкі на яго (пад вашую адказнасць), [звяжыцеся са мной](https://belarusaed.t.me).**

_Інстукцыя напісаная для Linux і MacOS. Калі вы ўпэненыя, што хочаце ўсталяваць агучку менавіта гэтым шляхам, раю
запусціць [Ubuntu](https://ubuntu.com) з флэшкі і зрабіць усе дзеянні з яе (гэта можна зрабіць без усталёўкі АС
непасрэдна на камп’ютар). Я перакананы, што гэта будзе нашмат прасцей, чым запускаць Linux у віртуальнай машыне._

---

## Усталёўка Android Platform Tools

### Ubuntu і падобныя

Для ўсталёўкі Android Platform Tools ва Ubuntu і падобныя дыстрыбутывы, запусціце Тэрмінал і выканайце наступныя
каманды:

```shell
sudo apt update
sudo apt upgrade -y
sudo apt install -y android-tools-adb
```

### Fedora, CentOS і падобныя

Для ўсталёўкі Android Platform Tools у Fedora і падобныя дыстрыбутывы, запусціце Тэрмінал і выканайце наступныя каманды:

```shell
sudo dnf update
sudo dnf install android-tools
```

### Arch

Для ўсталёўкі Android Platform Tools у Arch, звярніцеся да адпаведнай старонкі Arch
Wiki: [Android Debug Bridge](https://wiki.archlinux.org/title/Android_Debug_Bridge). Чытанне вікі — адзіны правільны
шлях выкарыстання Arch. Гэта быў асэнсаваны выбар.

### MacOS

Спачатку ўсталюйце [Homebrew](https://brew.sh/), калі ён у вас ягчэ не ўсталяваны. Для гэтага, у тэрмінале выканайце:

```shell
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
```

Пасля гэтага ўсталюйце непасрэдна Android Platform Tools:

```shell
brew install android-platform-tools
```

## Атрыманне root доступа да пыласоса

Для пачатку, стварыце файл `adb_shell` і захавайце ў яго нступны скрыпт:

```shell
#!/bin/sh
export ENV='/etc/adb_profile'
exec /bin/sh "$@"
```

Для гэтага можаце выкарыстоўваць nano: `nano adb_shell`. У вас прама ў тэрмінале адкрыецца тэкставы рэдактар. Устаўце ў
яго змесціва скрыпта:

- Linux: звычайна спалучэннем клавіш для тэрмінала з’яўляецца не звыклае `ctrl` + `v`, а `ctrl` + `shift` + `v`. Таксама
  можна націснуць правай кнопкай мышы —> уставіць
- MacOS: `cmd` + `v` ці клік правай кнопкай мышы (2 пальцы на трэкпадзе) —> уставіць

Для захавання, націсніце спачалку: `ctrl` + `o`, `enter`, затым `ctrl` + `x` для выхаду. На Mac
выкарыстоўвайце `control`, а не `command`.

Адразу ж, зададзім правы на выкананне скрыпта: `chmod 755 adb_shell`.

**Увага: гэта важны пункт. Калі пыласос не зможа выканаць скрыпт праз няправільная правы на яго, невядома, ці зможа ён
запусціцца.**

Скрыпт, што вы толькі што захавалі, дасць доступ да пыласоса праз adb, але спачатку трэба яго на пыласос запампаваць, а
для таго, яго спачатку трэба падлучыць. Для гэтага, здымаем з пыласоса шчотку, адкручваем крышку, што трымаецца на 4
вінціках, вынімаем акумулятар і адключаем яго. Пад ім будзе порт MicroUSB:

![Акумулятар і USB па ім](/blog/stytj02ym-voicepack-install-legacy/battery.jpg)

Цяпер, калі акумулятар адключаны, пыласос будзе сілкавацца ад USB, што нам зручна, бо яго давядзецца выключыць мноства
разоў. Перад падлучэннем, выканаем наступную кампанду:

```shell
while true; do adb push -a adb_shell /bin/adb_shell | grep -v "no devices"; done
```

Дадзеная каманда будзе пастаянна спрабаваць запампаваць скрыпт на пыласос. Гэта можа атрымацца не з першага разу, таму
запасайцеся цярплівасцю. Алгарытм пасля запуску каманды наступны:

1. Падлучыць пыласос
2. Чакаць рэакцыі:
   - Калі пыласос уключыўся і паведаміў пра гэта голасам, адключаем і падключаем занава.
   - Калі ў тэрмінале з’явіўся падобны надпіс: `adb_shell: 1 file pushed, 0 skipped. 0.0 MB/s (100 bytes in 0.033s)`,
     ціснем `ctrl` + `c` (`control` + `c` на Маку) каб спыніць пастаянную адпраўку.

Цяпер, выконваем наступную каманду:

```shell
while true; do (adb shell rm /etc/rc.d/S90robotManager && echo "Done") 2>&1 | grep -v "no devices"; done
```

Дзейнічаем па тым жа алгарытме, але цяпер чакаем надпісу `Done`. Дадзеная каманда адключыць аўтазапуск праграмы
пыласоса. Цяпер, калі вы перападлучыце пыласос, ён не павінен паведамляць пра ўключэнне голасам, кнопка ўключэння будзе
міргаць, і наогул на дадзеным этапе ён не будзе сябе паводзіць як пыласос — мы яго часова адключылі, каб ён не адключаў
нам доступ да сістэмы.

## Усталёўка агучкі

Цяпер спампоўваем
агучку: [спасылка](https://drive.google.com/file/d/1nZs8PWobxvOHb1qh5z_Xvfe7XchsFLGK/view?usp=sharing), распакоўваем у
папку карыстальніка, ці ў папку, адкуль запускалі тэрмінал. У выніку ў папцы, дзе запушчаны тэрмінал (па змаўчанні папка
карыстальніка) павінна быць папка `bel` з аўдыёфайламі ўнутры.

Далей выканваем наступныя каманды:

Спачатку паглядзім спіс агучак, які мы маем: `adb shell ls /usr/share/audio`. Кітайскі пыласос будзе мець 2
папкі: `mandarin` і `english`. На жаль, не ведаю, як яно працуе ў еўрапейскіх версіях. Калі ваш пыласос кажа на
еўрапейскай мове і яе назва прысутнічае ў спісе — скапіюйце ці запішыце яе сабе.

```shell
adb pull /usr/share/audio .
adb shell rm -rf /usr/share/audio/*
adb push bel /usr/share/audio/mandarin
adb shell ln -sf /usr/share/audio/mandarin /usr/share/audio/english
```

Разбяром іх па чарзе:

1. Мы спампавалі копію арыгінальных аўдыё з пыласоса: у вас мае з’явіцца папка audio, захавайце яе ў сябе ў якасці
   баявога трафея. Я сваю нікуды не захаваў, а значыць, акрамя вас, ніхто вам вярнуць арыгінальную агучку не зможа. Калі
   вы запускаеце Linux з флэшкі, скапіюйце папку на іншую флэшку ці куды-небудзь запампуйце, напрыклад на Google Дыск,
   бо пасля перазагрузкі ў вас знікнуць усе файлы.
2. Мы выдалілі тыя агучкі, што пыласос ужо меў. Гэта мы робім праз тое, што ў пыласоса занадта малое сховішча і калі не
   выдаліць старыя агучкі, новыя ў яго не ўлезуць.
3. Мы запампавалі папку з беларускай агучкай `bel` у папку агучак пад назвай `mandarin`— кітайская мова. Калі ў вас
   еўрапейскі пыласос на еўрапейскай мове і ў яе была асобная папка — устаўце сюды назву той папкі замест mandarin.
4. Мы зрабілі спасылку з `mandarin` на `english`, проста на ўсялякі выпадак.

Калі вы захочаце аднавіць усё назад, скарыстайцеся наступнымі камандамі (ТОЛЬКІ калі вы захавалі сабе арыгінальную папку
агучак):

```shell
adb shell rm -rf /usr/share/audio
adb push audio /usr/share/audio
```

Разбіраем:

1. Мы выдалілі цяперашнюю папку audio.
2. Мы запампавалі папку, якую вы папярэдне спампавалі з пыласоса.

Пасля таго, як агучка запампаваная, можна вярнуць у аўтазапуск праграму пыласоса:

```shell
adb shell ln -s /etc/init.d/robotManager /etc/rc.d/S90robotManager
```

Цяпер пыласос можна адключыць і сабраць назад. Калі ўсё зроблена правільна, пыласос павінен уключыцца і пачаць
размаўляць па-беларуску.

---

Асобная падзяка пану Мацею Вільчыньскаму, хто ў сваім блогу расказваў, як вырашаць праблемы, выкліканыя няўдалымі
абнаўленнямі. На ягоным артыкуле базавалася інструкцыя па атрыманні root-доступу. З арыгіналам можна азнаёміцца па
спасылцы: [Fixing stuck Xiaomi STYJ02YM updates](https://blog.lupin.rocks/fixing-xiaomi-styj02ym-update-stuck-on-80/).
